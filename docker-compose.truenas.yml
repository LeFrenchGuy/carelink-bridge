version: '3'

services:
  carelink-bridge:
    container_name: carelink-bridge
    image: your-dockerhub-username/carelink-bridge:latest
    restart: unless-stopped
    environment:
      NODE_ENV: production
      TZ: America/Toronto  # Timezone for log timestamps and system time
      
      # CareLink credentials - REQUIRED
      CARELINK_USERNAME: your-carelink-username
      CARELINK_PASSWORD: your-carelink-password
      
      # Nightscout configuration - REQUIRED
      API_SECRET: your-nightscout-api-secret
      NS: http://nightscout:1337
      
      # Region - OPTIONAL (default: EU)
      # MMCONNECT_SERVER: US
      
      # Advanced settings - OPTIONAL
      # CARELINK_INTERVAL: 300
      # CARELINK_SGV_LIMIT: 24
      # LOG_LEVEL: info  # Options: info (default), debug
    
    volumes:
      # Mount logindata.json as a file
      # WORKFLOW: 1) Start container (creates directory), 2) Stop container, 3) SCP file, 4) Restart
      - /mnt/apps-pool/app_configs/carelink-bridge/logindata.json:/app/logindata.json
      - /usr/share/zoneinfo:/usr/share/zoneinfo:ro
      - /etc/timezone:/etc/timezone:ro
    
    depends_on:
      - nightscout
